Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей 
применения."

Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и 
виртуализации на основе ОС.

    Аппаратная виртуализация - виртуализация с поддержкой специальной процессорной архитектуры. С помощью данной техники 
      возможно использование изолированных гостевых систем, управляемых гипервизором напрямую. Базовый слой — гипервизор: он 
      загружается на сервере и обеспечивает взаимодействие между аппаратным обеспечением сервера и виртуальными машинами. 
      Чтобы предоставить ресурсы виртуальным машинам, обеспечивается их виртуализация на сервере. 
      Виртуальные машины запускают свою собственную копию операционной системы и приложений на виртуализированном оборудовании. 

    Паравиртуализация - операционная система взаимодействует с программой гипервизора, который предоставляет ей 
    гостевой API, вместо использования напрямую таких ресурсов, как таблица страниц памяти. Гостевые операционные системы 
    подготавливаются для исполнения в виртуализированной среде, для чего их ядро незначительно модифицируется. 

    Виртуализация на основе ОС - работа нескольких экземпляров пространства пользователя в рамках одной ОС. Все задачи 
    гипервизора выполняются с помощью возможностей виртуализации, предоставляемых операционной системой физического сервера.

Вопрос:
В чём разница при работе с ядром гостевой ОС для полной и паравиртуализации?

    При полной виртуализации виртуальная машина полностью виртуализует все аппаратное обеспечение при 
    сохранении гостевой операционной системы в неизменном виде. При применении паравиртуализации нет 
    необходимости симулировать аппаратное обеспечение, однако, вместо этого (или в дополнение к этому), 
    используется специальный программный интерфейс (API) для взаимодействия с гостевой операционной 
    системой. Такой подход требует модификации кода гостевой системы. в полной виртуализации 
    немодифицированная ОС не осведомлена о виртуализации и использует двоичную трансляцию для 
    перехвата вызовов ОС во время выполнения. В паравиртуализации гипервызовы используются 
    вместо невиртуализируемых инструкций ОС, и весь этот процесс происходит во время компиляции, 
    где обрабатываются эти инструкции.

Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от 
условий использования.

Организация серверов:
физические сервера,
паравиртуализация,
виртуализация уровня ОС.

Условия использования:

Высоконагруженная база данных, чувствительная к отказу.
Различные web-приложения.
Windows системы для использования бухгалтерским отделом.
Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

    Высоконагруженная база данных, чувствительная к отказу - физические сервера.
    Данная организация выбрана, поскольку с помощью аппаратной виртуализации возможно получение изолированных 
    гостевых систем, управляемых гипервизором напрямую. Такой подход может обеспечить простоту 
      реализации платформы виртуализации и увеличить надежность платформы с несколькими одновременно 
      запущенными гостевыми системами, при этом нет потерь производительности на обслуживание хостовой системы.
      К достоинствам данного подхода можно причислить относительную простоту реализации, 
      универсальность и надежность решения; все функции управления берет на себя хост-ОС

      Различные web-приложения - виртуализация уровня ОС.Данный тип виртуализации позволяет использовать
      несколько изолированных экземпляров пространства пользователя вместо одного. Для данной задачи оправдан именно 
      такой тип виртуализации.


      Windows системы для использования бухгалтерским отделом - виртуализация уровня ОС. Такая виртуализация 
      может использоваться для приложений в рамках одной ОС. Данный тип виртуализации позволяет использовать
      несколько изолированных экземпляров пространства пользователя вместо одного.

      Системы, выполняющие высокопроизводительные расчеты на GPU - паравиртуализация. Операционная система 
      взаимодействует с программой гипервизора, который предоставляет ей гостевой API. Паравиртуализация 
      предлагает производительность почти как у реальной не виртуализированной системы. Как и при полной 
      виртуализации, одновременно могут поддерживаться многочисленные различные операционные системы. 
      Метод паравиртуализации позволяет добиться высокой производительности. Цель изменения интерфейса 
      заключается в сокращении доли времени выполнения гостя, отведённого на выполнение операций, 
      которые являются существенно более трудными для запуска в виртуальной среде по сравнению с 
      не-виртуальной средой. Паравиртуализация предоставляет специально установленные обработчики прерываний, 
      чтобы позволить гостю (гостям) и хосту принимать и опознавать эти задачи, которые иначе были бы 
      выполнены в виртуальном домене (где производительность меньше). 

2.3 насколько правильно контейнеризировать монолитные приложения?

    Это позволяет их масштабировать. Недостаток этого похода в том, что труднее масштабировать, если это 
    нужно сделать с частью приложения. Контейнеры позволяют с легкостью упаковывать код приложений, 
    их настройки и зависимости в удобные компоновочные блоки, обеспечивающие единообразие среды, 
    эффективность выполнения операций, продуктивную разработку и возможность контроля версий.


2.4 не будет проблем с доступом к видеокартам из ВМ?

Насколько я понимаю, паравиртуализация и доступ к аппаратным ресурсам будет осуществляться гипервизором.
Можно, наверное, назначить выделенные графические процессоры виртуальным машинам.

Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1 . 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. 
Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, 
репликации данных и автоматизированного механизма создания резервных копий.

      Выбрана VMware vSphere Standard или Enterprise
      а)в слое гипервизора находятся планировщик ресурсов,распределенная файловая система,
      стек хранения данных 
      б) хорошая поддержка и высокий уровень безопасности
      в) выбор обусловлен тем, что для использования средств резервного копирования и восстановления после сбоев требуется 
      платное решение. 
      г) в качестве хостовых могут использоваться Windows и Linux платформы, что позволяет использовать 
      виртуализацию в гетерогенной среде предприятия
      д) есть vSphere Replication механизм репликации данных виртуальных машин по LAN и WAN, упрощена репликация
      на уровне виртуальной машины
      е) есть балансировщик нагрузки сети
      ж) есть средства создания резервных копий данных, нативный vCenter Backup and Restore

2 . Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой 
(20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.

      Выбрано KVM

      а) внедрена поддержка широкого ряда процессоров и ОС, среди которых, помимо Linux, 
      наиболее известными являются Windows, CentOS, Solaris, BSD
      б) Сервер KVM может работать на всех ОС
      в) Все компоненты программного обеспечения KVM открыты
      г) используется стандартную модель безопасности Linux для изоляции и управления ресурсами
      д) KVM поддерживает новейшие функции виртуализации памяти от производителей процессоров для минимизации загрузки 
      процессора и достижения высокой пропускной способности
      е) KVM поддерживает динамическую миграцию, обеспечивая возможность перемещения работающих виртуальных машин между 
      физическими узлами без прерывания обслуживания
      ж) KVM унаследовал производительность и масштабируемость Linux. Производительность в 95-135% по сравнению 
      с "голым железом" в реальных корпоративных приложениях. Свыше миллиона сообщений в секунду и менее чем 200-мкс 
      задержку в виртуальных машинах, работающих на стандартном сервере


3 . Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации 
Windows инфраструктуры.

      Выбран XenServer (Free)
      а) способен запускать виртуальные машины как в режиме полной виртуализации, так и в режиме «пара-виртуализации»
      б) Особенностью Xen является наличие домена dom0, который на самом деле управляет физическим сервером. 
      Виртуальные машины запускаются в dom1, dom2 и так далее
      г) возможность живой миграции работающих виртуальных машин между хостами
      д)  Поддержка платформ x86/32, x86/32 с PAE и x86/64;
      Поддержка аппаратной виртуализации Intel Virtualization Techonology (VT-x) 
      для запуска немодифицированных операционных систем (включая Microsoft Windows)

4 . Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

      Выбран продукт виртуальных лаборатория VMware LabManager.

      а) Работа с многомашинными конфигурациями как с единым модулем, возможность публикации этих модулей
      б) демонстрация дефектов путем передачи ссылок на проблемную ситуацию, сохраненную в виде снимка 
      состояния гостевой системы 
      в) Централизованное обслуживание и развертывание обновлений в тестовых окружениях 
      г) Мониторинг загрузки серверов тестирования
      д) быстрое развертывание виртуальных машины на серверах тестирования и контролировать использование виртуальных систем, 
      при этом процесс выглядит так, будто пользователь работает с физическим компьютером
      е) интеграция с популярными средствами тестирования Borland SilkCentral Test Manager и HP Quality Center, 
      имеет возможности для развертывания шаблонов в несколько кликов мыши, поддерживает протокол LDAP, 
      легко интегрируется с другими решениями для виртуальной инфраструктуры VMware и имеет возможности для 
      автоматизации операций посредством собственного API
      ж) поддержка платформ виртуализации различных вендоров. В качестве основы виртуальной тестовой лаборатории можно 
      использовать платформы Microsoft (Virtual Server), Xen (XenEnterprise) и VMware (ESX Server и Server)


Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких 
систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и 
проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш 
ответ примерами.

      - проблема управления разными средами из-за частого перемещения данных между ними. Привер: виртуализация окружений с
         разными ОС, перемещение данных из физической среды в виртуальную
      -  компания зависит от продукции не одного вендора, для управления таким «лоскутным одеялом» требуется 
         целый набор специалистов различного профиля. Некоторые гипервизоры требуют знаний - VMWare
      - проблема совместимости различных систем и масштабируемости инфраструктуры: не все гипервизоры поддерживают все 
        устройства и ОС, есть ограничения
  

